<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FundTrackerAI — Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="app-shell">
    <div class="card">

      <!-- BRAND HEADER -->
      <div class="brand-row">
        <div class="brand-mark">$</div>
        <div>
          <h1>FundTrackerAI</h1>
          <h2>Verified Transaction System</h2>
        </div>
      </div>

      <h2>Donation Dashboard</h2>
      <p class="subtext">Real-time verified history of all processed donations.</p>

      <div id="stats" style="display:flex; gap:16px; margin-top:18px;">
        <div class="stat-card">
          <p>Total Raised</p>
          <h3 id="total-amount">$0.00</h3>
        </div>

        <div class="stat-card">
          <p>Total Donations</p>
          <h3 id="total-donations">0</h3>
        </div>
      </div>

      <div class="table-wrap">
        <table id="donationTable">
          <thead>
            <tr>
              <th>Email</th>
              <th>Amount</th>
              <th>SoulMarkⓈ</th>
              <th>Timestamp</th>
            </tr>
          </thead>
          <tbody>
            <tr><td colspan="4">Loading...</td></tr>
          </tbody>
        </table>
      </div>

    </div>
  </div>

  <script>
    fetch("https://fundtrackerai.onrender.com/donations")
      .then(res => res.json())
      .then(data => {
        const donations = data.donations || [];

        const totalAmount = donations.reduce((s, d) => s + d.amount, 0);
        document.getElementById("total-amount").textContent =
          "$" + (totalAmount / 100).toFixed(2);

        document.getElementById("total-donations").textContent =
          donations.length.toString();

        const rows = donations.map(d => `
          <tr>
            <td>${d.email}</td>
            <td>$${(d.amount / 100).toFixed(2)}</td>
            <td class="truncate" title="${d.soulmark}">${d.soulmark}</td>
            <td>${new Date(d.timestamp).toLocaleString()}</td>
          </tr>
        `).join("");

        document.querySelector("#donationTable tbody").innerHTML = rows;
      })
      .catch(() => {
        document.querySelector("#donationTable tbody").innerHTML =
          "<tr><td colspan='4'>Error loading data</td></tr>";
      });
  </script>

</body>
</html>