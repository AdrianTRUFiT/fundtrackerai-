<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="card">
  <h2>Payment Status</h2>
  <div id="result" class="status">Checking...</div>

  <a href="dashboard.html" id="dashboardBtn" class="btn" style="display:none;">
    View Donation Dashboard
  </a>
</div>

<script>
async function verify() {
  const params = new URLSearchParams(window.location.search);
  const id = params.get("session_id");

  if (!id) {
    document.getElementById("result").innerText = "Invalid session ❌";
    document.getElementById("result").classList.add("fail");
    return;
  }

  const res = await fetch(`https://fundtrackerai.onrender.com/verify-donation/${id}`);
  const data = await res.json();

  const statusEl = document.getElementById("result");
  const btn = document.getElementById("dashboardBtn");

  if (data.verified) {
    statusEl.innerText = "Payment Verified ✔";
    statusEl.classList.add("success");
    btn.style.display = "inline-block";
  } else {
    statusEl.innerText = "Verification Failed ❌";
    statusEl.classList.add("fail");
  }
}

verify();
</script>

</body>
</html>